
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Compressing JSON - lzwCompress.js - Hari Menon</title>
  <meta name="author" content="Hari Menon">

  
  <meta name="description" content="The application that I am working on now is a nice little ASP.NET MVC4 web app, whose target audience will access it on some of the popular tablets &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="msvalidate.01" content="09CA63FA87D1D25673E09F580DDBA74D" />

  
  <link rel="canonical" href="https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hari Menon" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

    <meta property="twitter:card" content="summary">
    <meta property="twitter:site" content="menonHari">
    <meta property="twitter:url" content="https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/">
    <meta property="twitter:title" content="Compressing JSON - lzwCompress.js">
    <meta property="twitter:description" content="The application that I am working on now is a nice little ASP.NET MVC4 web app, whose target audience will access it on some of the popular tablets of the day - iPad, Android and Windows 8 Surface &hellip;">


<!-- favicon etc. -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-4869398-4', 'harimenon.com');
        ga('send', 'pageview');

    </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hari Menon</a></h1>
  
    <h2>Namaste. Welcome to my personal space on the world wide web!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:harimenon.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">Home</a></li>
    <li><a href="/blog">Blog</a></li>
    <li><a href="/blog/categories/malayalam-blog/">Malayalam</a></li>
    <li><a href="/blog/categories/english-blog/">English</a></li>
    <li><a href="/blog/categories/technical/">Technical</a></li>
    <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Compressing JSON - lzwCompress.js</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-07T03:36:00+00:00" pubdate data-updated="true">Dec 7<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>The application that I am working on now is a nice little ASP.NET MVC4 web app, whose target audience will access it on some of the popular tablets of the day - iPad, Android and Windows 8 Surface etc.!</p>

<p>The USP of the otherwise regular data entry app is that it has an offline mode, so that the data collection can happen even when there is no connectivity. Even with ubiquity of the data networks, this proved to be the critical aspect of the app for the client. And among the things being cached for offline mode, there is some really hefty business look-up/metadata, that has to be there for the app to function. The fact that the app would be targeting multiple devices, and because the HTML5 recommended <a href="http://www.w3.org/TR/IndexedDB/">IndexedDB API</a> is still not implemented by some of the major players (Opera or Safari or any iOS6 browser), we had to fall back to the better/older/more-robust and now-deprecated <a href="http://www.w3.org/TR/webdatabase/">Web SQL database</a> as well.</p>

<!-- more -->


<p>The app would be online, when certain business entities would get enabled for offline mode, and this is when it takes down the metadata in JSON format, to the device-supported offline database. And because this data was pretty big (approximately 15 meg per entity), this offline-enabling itself was consuming quite a bit of space. And that was just the set up with the static look up data. The main point of the app, once again, is that it helps adding transactions/entities to the offline-enabled entity, using this look-up data. These transactions again have to go to the same offline databases as JSON, and there could be a couple of hundred of these, on a single device, with almost all of them having one or two (BASE64 encoded JPEG) photos as well.</p>

<p>Now, at around a few hundred megs of offline data, the browsers start getting less responsive and might even start crashing when visiting pages from that domain (this bit is not confirmed across all the devices/browsers). So the gist is: we had to look into somehow optimizing the data getting stored into the device.</p>

<p>First thing I looked into was optimizing the redundancy innate to the JSON structure - that of the repeating keys. There were quite a <a href="https://github.com/WebReflection/JSONH">few</a> such <a href="http://www.cliws.com/e/06pogA9VwXylo_GknPEeFA/">optimizations</a> on the web and <a href="http://stackoverflow.com/questions/4433402/replace-keys-json-in-javascript">this Stack Overflow question</a> is what finally I took. That alone shaved off around 20% in average, which was nice but not nearly enough.</p>

<p>Then I started exploring compression algorithms like gzip or lzw or some other such for compressing the JSON strings. And stumbled on to <a href="http://stackoverflow.com/questions/2252465/javascript-client-data-compression">this (SO again!)</a>. I started off with the <a href="http://rosettacode.org/wiki/LZW_compression#JavaScript">JS implementation</a> mentioned in the answer there and enhanced a little bit it to make it do the JSON-key-redundancy optimization as well.</p>

<p><a href="http://floydpink.github.com/lzwCompress.js/">lzwCompress.js</a> was the result!</p>

<p>The simple usage as given in the github readme page is:</p>

<div><script src='https://gist.github.com/4230480.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>All (well, almost all - there are <a href="http://htmlpreview.github.com/?https://github.com/floydpink/lzwCompress.js/blob/master/test/test.html">a few unit tests</a> that pass) valid JavaScript objects, when applied through the pack and unpack cycled would retain its structure and form. And most of them would have an average compression of 45-80% after the pack, which is what could be used to store to offline databases, maybe sending up to server etc.</p>

<p>Feel free to use it for anything where you would need compression of your JSON (or any JavaScript) data structures.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Hari Menon</span></span>

      








  


<time datetime="2012-12-07T03:36:00+00:00" pubdate data-updated="true">Dec 7<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/json-compression/'>JSON Compression</a>, <a class='category' href='/blog/categories/json-key-optimization/'>JSON Key Optimization</a>, <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/compressing-json/'>compressing JSON</a>, <a class='category' href='/blog/categories/indexeddb/'>indexedDb</a>, <a class='category' href='/blog/categories/lzwcompress-js/'>lzwCompress.js</a>, <a class='category' href='/blog/categories/technical/'>technical</a>, <a class='category' href='/blog/categories/websql-database/'>webSql database</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/" data-via="menonHari" data-counturl="https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/12/06/useful-git-commands/" title="Previous Post: Useful git commands">&laquo; Useful git commands</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/12/16/aop-for-logging-in-net/" title="Next Post: AOP for logging in .NET">AOP for logging in .NET &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
    <h1>About Me</h1>
    <p>Check out my <a href="http://about.me/hpachuveetil">about.me page</a>.</p>
    <h2 class="social-icons">
        <!-- Social Media Icons: Font Awesome by Dave Gandy - http://fontawesome.io -->
        <a href="https://github.com/floydpink" title="GitHub"><i class="fa fa-github-square fa-lg"></i></a>
        <a href="http://stackoverflow.com/users/218882/floyd-pink" title="Stack Overflow"><i class="fa fa-stack-overflow fa-lg"></i></a>
        <a href="http://twitter.com/menonHari" title="Twitter"><i class="fa fa-twitter-square fa-lg"></i></a>
        <a href="http://www.linkedin.com/in/haridaspachuveetil" title="LinkedIn"><i class="fa fa-linkedin-square fa-lg"></i></a>
        <a href="http://careers.stackoverflow.com/hari" title="Stack Overflow Careers"><i class="fa fa-signal fa-lg"></i></a>
        <a href="http://flickr.com/photos/me_haridas" title="Flickr"><i class="fa fa-flickr fa-lg"></i></a>
        <a href="https://plus.google.com/115681177381332236508/about" title="Google+"><i class="fa fa-google-plus-square fa-lg"></i></a>
    </h2>
    <p><a href="/gpg/public-key.txt" title="If you need to send me a really secure email !">My GPG Key</a></p>
    <p><a href="/blog/2014/12/30/resume/" title="My résumé imported from Stack Overflow Careers!">My Résumé</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/01/25/ios-app-for-malayalam-bhagavad-gita/">iOS App for Malayalam Bhagavad Gita</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/30/resume/">Résumé</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/10/android-app-for-malayalam-bhagavad-gita/">Android App For Malayalam Bhagavad Gita</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/15/a-full-blossom/">A Full Blossom</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/20/srimad-bhagavad-gita/">ശ്രീമദ് ഭഗവദ്ഗീത</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Stack Overflow</h1>
  <a href="http://stackoverflow.com/users/218882/floyd-pink" style="white-space: normal;">
  <img src="https://stackoverflow.com/users/flair/218882.png" width="208" height="58" alt="Stack Overflow profile: Floyd Pink" title="Stack Overflow profile: Floyd Pink">
  </a>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/floydpink">@floydpink</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'floydpink',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <p><a class="twitter-timeline" href="https://twitter.com/menonHari" data-widget-id="363374556922146816">Tweets by @menonHari</a></p>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/115681177381332236508?rel=author">
      <img src="https://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p title="Last Updated: 2015-12-18T17:41:12+00:00">
  Copyright &copy; 2009 - 2015 - Hari Menon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'harimenonenglishblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/';
        var disqus_url = 'https://www.harimenon.com/blog/2012/12/07/lzwCompress.js/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
