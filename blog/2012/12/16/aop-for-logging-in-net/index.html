
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>AOP for logging in .NET - Hari Menon</title>
  <meta name="author" content="Hari Menon">

  
  <meta name="description" content="UPDATE (02/24/2013):
I did manage to figure out (thanks to Jon Skeet answering my question on SO) how to tackle the async/await scenario for a AOP &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="msvalidate.01" content="09CA63FA87D1D25673E09F580DDBA74D" />

  
  <link rel="canonical" href="https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hari Menon" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

    <meta property="twitter:card" content="summary">
    <meta property="twitter:site" content="menonHari">
    <meta property="twitter:url" content="https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/">
    <meta property="twitter:title" content="AOP for logging in .NET">
    <meta property="twitter:description" content="UPDATE (02/24/2013):
I did manage to figure out (thanks to Jon Skeet answering my question on SO) how to tackle the async/await scenario for a AOP logger using StructureMap and DynamicProxy. Check &hellip;">


<!-- favicon etc. -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
  
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-4869398-4', 'harimenon.com');
        ga('send', 'pageview');

    </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hari Menon</a></h1>
  
    <h2>Namaste. Welcome to my personal space on the world wide web!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:harimenon.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">Home</a></li>
    <li><a href="/blog">Blog</a></li>
    <li><a href="/blog/categories/malayalam-blog/">Malayalam</a></li>
    <li><a href="/blog/categories/english-blog/">English</a></li>
    <li><a href="/blog/categories/technical/">Technical</a></li>
    <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">AOP for Logging in .NET</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-16T19:23:00+00:00" pubdate data-updated="true">Dec 16<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><strong>UPDATE (02/24/2013):</strong>
I did manage to figure out (thanks to Jon Skeet <a href="http://stackoverflow.com/a/14288190/218882">answering</a> my question on SO) how to tackle the async/await scenario for a AOP logger using StructureMap and DynamicProxy. Check out <del><a href="https://github.com/floydpink/LoggerPoc/tags">the tag v0.2</a></del> <a href="https://github.com/floydpink/LoggerPoc/tags">the tag v0.3</a> [1] on GitHub for the source.</p>

<hr />


<p>Implementing the <a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">AOP pattern</a> into a C# .NET application is something I always wanted to do. I had tried PostSharp with a few other team members, a while ago, but could not get it working soon enough, that we quit the attempt after a while.</p>

<p>After reading up a little more (<a href="http://docs.castleproject.org/Default.aspx?Page=Introduction-to-AOP-With-Castle&amp;amp;NS=Windsor&amp;amp;AspxAutoDetectCookieSupport=1">here</a>, <a href="http://weblogs.asp.net/thangchung/archive/2011/01/25/aop-with-structuremap-container.aspx">here</a> and <a href="http://ayende.com/blog/3474/logging-the-aop-way">here</a>) I am now trying it all over again in the <a href="http://flickrdownloadr.com/">flickr downloadr</a> that I am now working on.</p>

<p>I still haven’t completely cracked it, because the Flickr Downloadr WPF app heavily uses the new asynchrony features (async/await etc.) from .NET 4.5. I hope to somehow adapt the dynamic proxy based intercept paradigm to make it work with the new asynchronous model soonand I shall follow this up here then with the details.</p>

<!-- more -->


<p>Meanwhile, here’s <a href="https://github.com/floydpink/LoggerPoc/tags">the solution on GitHub (as tag v0.1)</a> that is a proof-of-concept console app, which calls into two separate service classes. As long as there are no asynchrony features from .NET. 4.5 in your app, you should be able to make use of this pattern.</p>

<p>There is some business specific logging (what I call organic logging )happening inside one of these service classes themselves. But there is also code enables aop logging of all the entry and exit into every method in these pseudo- business objects.</p>

<p>The main method that does the AOP magic is the Intercept method of the IInterceptor interface.</p>

<div><script src='https://gist.github.com/4315686.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>It could peep into the method being called, its arguments, its return type etc. through the invocation instance, do things like logging and then make the real call to the real invocation. The try/catch that is implemented at this level could be the only place that happens. Auditing, authentication etc. could also be implemented at this layer to affect all the classes/methods one chooses.</p>

<p>[1] - <small>[updated: 03/25/2014]</small></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Hari Menon</span></span>

      








  


<time datetime="2012-12-16T19:23:00+00:00" pubdate data-updated="true">Dec 16<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/-net/'>.NET</a>, <a class='category' href='/blog/categories/aop/'>AOP</a>, <a class='category' href='/blog/categories/castle-dynamic-proxy/'>Castle Dynamic Proxy</a>, <a class='category' href='/blog/categories/structuremap/'>StructureMap</a>, <a class='category' href='/blog/categories/aspect-oriented-programming/'>aspect oriented programming</a>, <a class='category' href='/blog/categories/cross-cutting-concerns/'>cross-cutting concerns</a>, <a class='category' href='/blog/categories/instrumentation/'>instrumentation</a>, <a class='category' href='/blog/categories/log4net/'>log4net</a>, <a class='category' href='/blog/categories/logging/'>logging</a>, <a class='category' href='/blog/categories/technical/'>technical</a>, <a class='category' href='/blog/categories/tracing/'>tracing</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/" data-via="menonHari" data-counturl="https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/12/07/lzwCompress.js/" title="Previous Post: Compressing JSON - lzwCompress.js">&laquo; Compressing JSON - lzwCompress.js</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/01/15/single-click-deployment/" title="Next Post: Single-click Deployment of WPF Application to GitHub Pages">Single-click Deployment of WPF Application to GitHub Pages &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
    <h1>About Me</h1>
    <p>Check out my <a href="http://about.me/hpachuveetil">about.me page</a>.</p>
    <h2 class="social-icons">
        <!-- Social Media Icons: Font Awesome by Dave Gandy - http://fontawesome.io -->
        <a href="https://github.com/floydpink" title="GitHub"><i class="fa fa-github-square fa-lg"></i></a>
        <a href="http://stackoverflow.com/users/218882/floyd-pink" title="Stack Overflow"><i class="fa fa-stack-overflow fa-lg"></i></a>
        <a href="http://twitter.com/menonHari" title="Twitter"><i class="fa fa-twitter-square fa-lg"></i></a>
        <a href="http://www.linkedin.com/in/haridaspachuveetil" title="LinkedIn"><i class="fa fa-linkedin-square fa-lg"></i></a>
        <a href="http://careers.stackoverflow.com/hari" title="Stack Overflow Careers"><i class="fa fa-signal fa-lg"></i></a>
        <a href="http://flickr.com/photos/me_haridas" title="Flickr"><i class="fa fa-flickr fa-lg"></i></a>
        <a href="https://plus.google.com/115681177381332236508/about" title="Google+"><i class="fa fa-google-plus-square fa-lg"></i></a>
    </h2>
    <p><a href="/gpg/public-key.txt" title="If you need to send me a really secure email !">My GPG Key</a></p>
    <p><a href="/blog/2014/12/30/resume/" title="My résumé imported from Stack Overflow Careers!">My Résumé</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/01/25/ios-app-for-malayalam-bhagavad-gita/">iOS App for Malayalam Bhagavad Gita</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/30/resume/">Résumé</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/10/android-app-for-malayalam-bhagavad-gita/">Android App For Malayalam Bhagavad Gita</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/15/a-full-blossom/">A Full Blossom</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/20/srimad-bhagavad-gita/">ശ്രീമദ് ഭഗവദ്ഗീത</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Stack Overflow</h1>
  <a href="http://stackoverflow.com/users/218882/floyd-pink" style="white-space: normal;">
  <img src="https://stackoverflow.com/users/flair/218882.png" width="208" height="58" alt="Stack Overflow profile: Floyd Pink" title="Stack Overflow profile: Floyd Pink">
  </a>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/floydpink">@floydpink</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'floydpink',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <p><a class="twitter-timeline" href="https://twitter.com/menonHari" data-widget-id="363374556922146816">Tweets by @menonHari</a></p>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/115681177381332236508?rel=author">
      <img src="https://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p title="Last Updated: 2015-12-18T17:41:12+00:00">
  Copyright &copy; 2009 - 2015 - Hari Menon -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'harimenonenglishblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/';
        var disqus_url = 'https://www.harimenon.com/blog/2012/12/16/aop-for-logging-in-net/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
